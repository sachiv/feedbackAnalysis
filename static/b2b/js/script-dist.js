function getCookie(e){var a=null;if(document.cookie&&""!=document.cookie)for(var t=document.cookie.split(";"),i=0;i<t.length;i++){var r=jQuery.trim(t[i]);if(r.substring(0,e.length+1)==e+"="){a=decodeURIComponent(r.substring(e.length+1));break}}return a}function makeDashChart(e,a,t){require(["echarts","echarts/chart/line","echarts/chart/bar"],function(i){dashChart=i.init(document.getElementById("dashChart"),"macarons");var r={title:{text:e,textStyle:{color:"#3F51B5"},subtext:"No. of Hits"},color:["#3F51B5","#434553"],tooltip:{trigger:"axis"},legend:{data:["Happy","Unhappy"]},toolbox:{show:!0,feature:{magicType:{show:!0,type:["line","bar","stack","tiled"],title:{line:"Line",bar:"Bar",stack:"Stack",tiled:"Tiled"}},restore:{show:!0,title:"Restore"},saveAsImage:{show:!0,title:"Save as Image"}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!0,axisLine:{show:!1},axisTick:{show:!1},data:tick_x}],yAxis:[{axisLine:{show:!1},axisTick:{show:!1},type:"value"}],series:[{name:"Unhappy",symbol:"bar",symbolSize:0,lineStyle:{width:0},borderColor:"rgba(0,0,0,0)",type:"bar",stack:"A",itemStyle:{normal:{areaStyle:{type:"default"}}},data:t},{name:"Happy",symbol:"bar",symbolSize:0,lineStyle:{width:0},type:"bar",stack:"A",itemStyle:{normal:{areaStyle:{type:"default"}}},data:a}]};dashChart.setOption(r),$(window).resize(function(){dashChart.resize()})})}function makeRatingDashChart(e){require(["echarts","echarts/chart/line","echarts/chart/bar"],function(a){myChart=a.init(document.getElementById("ratingDashChart"),"macarons");var t={tooltip:{trigger:"axis"},legend:{data:["Ambience","Cost","Food","Service","Overall"]},toolbox:{show:!0,feature:{magicType:{show:!0,type:["line","bar","stack","tiled"],title:{line:"Line",bar:"Bar",stack:"Stack",tiled:"Tiled"}},restore:{show:!0,title:"Restore"},saveAsImage:{show:!0,title:"Save as Image"}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!0,axisLine:{show:!1},axisTick:{show:!1},data:tick_x}],yAxis:[{axisLine:{show:!1},axisTick:{show:!1},type:"value"}],series:[{name:"Ambience",type:"bar",symbolSize:5,itemStyle:{normal:{lineStyle:{width:3}}},data:e[0]},{name:"Cost",type:"bar",symbolSize:5,itemStyle:{normal:{lineStyle:{width:3}}},data:e[1]},{name:"Food",type:"bar",symbolSize:5,itemStyle:{normal:{lineStyle:{width:3}}},data:e[2]},{name:"Service",type:"bar",symbolSize:5,itemStyle:{normal:{lineStyle:{width:3}}},data:e[3]},{name:"Overall",type:"bar",symbolSize:5,itemStyle:{normal:{areaStyle:{type:"default"},lineStyle:{width:3}}},data:e[4]}]};myChart.setOption(t),$(window).resize(function(){myChart.resize()})})}function setData(e){backUpData=[],backUpData=e}function doughnut_percent(e,a){return parseFloat(e/a*100).toFixed(1)+"%"}function doughnut_color(e,a){return parseFloat(doughnut_percent(e,a))>50?"#3F51B5":"#434553"}function makeDoughnutChart(e,a,t){var i=5*t,r={normal:{label:{show:!1},labelLine:{show:!1}}},n={normal:{color:"#EEE",label:{show:!0,position:"center"},labelLine:{show:!1}},emphasis:{color:"rgba(0,0,0,0)"}},s=[53,60];require(["echarts","echarts/chart/pie"],function(t){var c=t.init(document.getElementById(e),"macarons");option={series:[{type:"pie",radius:s,itemStyle:{normal:{color:doughnut_color(a,i),label:{position:"center",formatter:function(){return doughnut_percent(a,i)},textStyle:{fontSize:"25",color:doughnut_color(a,i)}}}},data:[{value:a,itemStyle:r},{value:i-a,itemStyle:n}]}]},c.setOption(option),$(window).resize(function(){c.resize()})})}function loadDashboard(e){setData(e);if(tick_x=[],"WEEK"==TIME_FILTER||"WEEKLY"==TIME_FILTER)tick_x=["MON","TUE","WED","THU","FRI","SAT","SUN"];else if("YEAR"==TIME_FILTER||"YEARLY"==TIME_FILTER)tick_x=["","JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];else for(var a=0;X_MAX>a;a++)tick_x[a]=a;"DAY"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.day[1],e.feedback.day[0]),makeRatingDashChart(e.rating.day)):"WEEK"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.week[1],e.feedback.week[0]),makeRatingDashChart(e.rating.week)):"MONTH"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.month[1],e.feedback.month[0]),makeRatingDashChart(e.rating.month)):"YEAR"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.year[1],e.feedback.year[0]),makeRatingDashChart(e.rating.year)):"DAILY"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.daily[1],e.feedback.daily[0]),makeRatingDashChart(e.rating.daily)):"WEEKLY"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.weekly[1],e.feedback.weekly[0]),makeRatingDashChart(e.rating.weekly)):"MONTHLY"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.monthly[1],e.feedback.monthly[0]),makeRatingDashChart(e.rating.monthly)):"YEARLY"===TIME_FILTER?(makeDashChart("FEEDBACKS",e.feedback.yearly[1],e.feedback.yearly[0]),makeRatingDashChart(e.rating.yearly)):(makeDashChart("FEEDBACKS",e.feedback.monthly[1],e.feedback.monthly[0]),makeRatingDashChart(e.rating.monthly));var t=e.pie.nb_feedbacks;makeDoughnutChart("qs1Chart",e.pie.ratings[0],t),makeDoughnutChart("qs2Chart",e.pie.ratings[1],t),makeDoughnutChart("qs3Chart",e.pie.ratings[2],t),makeDoughnutChart("qs4Chart",e.pie.ratings[3],t),makeDoughnutChart("qd1Chart",e.pie.ratings[4],e.pie.nb_qd1),makeDoughnutChart("qd2Chart",e.pie.ratings[5],e.pie.nb_qd2)}function loadEmployeeChart(e){setData(e);if(tick_x=[],"WEEK"==TIME_FILTER||"WEEKLY"==TIME_FILTER)tick_x=["MON","TUE","WED","THU","FRI","SAT","SUN"];else if("YEAR"==TIME_FILTER||"YEARLY"==TIME_FILTER)tick_x=["","JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];else for(var a=0;X_MAX>a;a++)tick_x[a]=a;"DAY"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.day[1],e.feedback.day[0]):"WEEK"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.week[1],e.feedback.week[0]):"MONTH"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.month[1],e.feedback.month[0]):"YEAR"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.year[1],e.feedback.year[0]):"DAILY"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.daily[1],e.feedback.daily[0]):"WEEKLY"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.weekly[1],e.feedback.weekly[0]):"MONTHLY"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.monthly[1],e.feedback.monthly[0]):"YEARLY"===TIME_FILTER?makeDashChart("EMPLOYEE",e.feedback.yearly[1],e.feedback.yearly[0]):makeDashChart("EMPLOYEE",e.feedback.monthly[1],e.feedback.monthly[0])}function loadDashboardOwner(e){setData(e);tick_x=e.names,console.log(tick_x),"DAY"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.today,e.greys.today):"WEEK"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.all,e.greys.all):"MONTH"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.all,e.greys.all):"YEAR"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.all,e.greys.all):"DAILY"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.today,e.greys.today):"WEEKLY"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.all,e.greys.all):"MONTHLY"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.all,e.greys.all):"YEARLY"===TIME_FILTER?makeDashChart("FEEDBACKS",e.greens.all,e.greys.all):makeDashChart("FEEDBACKS",e.greens.all,e.greys.all)}var CUT_OFF=2,X_MAX=31,backUpData=[],myChart=[],tick_x=[],TIME_FILTER="MONTH",TYPE_FILTER=6;$(function(){$("#menu-toggle").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")}),$.material.init(),require.config({paths:{echarts:"/static/b2b/js/echarts/"}});$("#newsTicker").newsTicker({row_height:80,max_rows:5,duration:4e3});$("#timeDaily").click(function(){TYPE_FILTER=6,TIME_FILTER="DAILY",X_MAX=24,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#timeWeekly").click(function(){TYPE_FILTER=6,TIME_FILTER="WEEKLY",X_MAX=7,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#timeMonthly").click(function(){TYPE_FILTER=6,TIME_FILTER="MONTHLY",X_MAX=31,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#timeYearly").click(function(){TYPE_FILTER=6,TIME_FILTER="YEARLY",X_MAX=12,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#timeYear").click(function(){TYPE_FILTER=6,TIME_FILTER="YEAR",X_MAX=12,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#timeMonth").click(function(){TYPE_FILTER=6,TIME_FILTER="MONTH",X_MAX=31,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#timeWeek").click(function(){TYPE_FILTER=6,TIME_FILTER="WEEK",X_MAX=7,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#timeDay").click(function(){TYPE_FILTER=6,TIME_FILTER="DAY",X_MAX=24,$(this).parent().children().removeClass("active"),$(this).addClass("active"),loadDashboard(backUpData)}),$("#allFilter").click(function(){$(".grey").fadeIn(),$(".green").fadeIn(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#greyFilter").click(function(){$(".grey").fadeIn(),$(".green").fadeOut(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#greenFilter").click(function(){$(".green").fadeIn(),$(".grey").fadeOut(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#commentFilter").click(function(){$(".nocomment").fadeOut(),$(".comment").fadeIn(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#nocommentFilter").click(function(){$(".comment").fadeOut(),$(".nocomment").fadeIn(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#starFilter").click(function(){$(".unstarred").fadeOut(),$(".starred").fadeIn(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#unstarFilter").click(function(){$(".starred").fadeOut(),$(".unstarred").fadeIn(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#returningFilter").click(function(){$(".nonreturning").fadeOut(),$(".returning").fadeIn(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$("#nonreturningFilter").click(function(){$(".returning").fadeOut(),$(".nonreturning").fadeIn(),$(this).parent().children().removeClass("active"),$(this).addClass("active")}),$(".toggleStar").click(function(){var e=0;if(this.checked){e=1;var a=$(this).parent().parent().parent().parent();a.removeClass("unstarred"),a.addClass("starred")}else{var a=$(this).parent().parent().parent().parent();a.removeClass("starred"),a.addClass("unstarred")}$.ajax({type:"POST",url:"/accounts/profile/feedbacks/post/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),id:$(this).attr("name"),status:e}}).done(function(){}).fail(function(){return!1})}),$("#promosmsTypeCheckbox").click(function(){this.checked?$("#b_entity").fadeIn():$("#b_entity").fadeOut()}),$(".promoTemplateActive").click(function(){var e=!1;this.checked&&(e=!0),$.ajax({type:"POST",url:"/staff/dashboard/promosms/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),id:$(this).attr("name"),status:e}}).done(function(){}).fail(function(){return!1})}),$(".smsAccountActive").click(function(){var e=!1;this.checked&&(e=!0),$.ajax({type:"POST",url:"/staff/dashboard/smsaccount/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),id:$(this).attr("name"),status:e}}).done(function(){}).fail(function(){return!1})}),$(".smsAccountTransActive").click(function(){var e=!1;this.checked&&(e=!0),$.ajax({type:"POST",url:"/staff/dashboard/smsaccount/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),idt:$(this).attr("name"),status:e}}).done(function(){}).fail(function(){return!1})}),$("select#package").change(function(){package=$("select#package").find(":selected").val(),$("#"+package).fadeOut()});var e=0;$("select#b_entity").change(function(){e=parseFloat($("select#b_entity").find(":selected").data("bal")),$("#balance").html(e),$("#balanceLeft").html(e),parseFloat($("select#b_entity").find(":selected").data("bal"))?$("input#quantity").prop("disabled",!1):$("input#quantity").prop("disabled",!0)}),$("input#quantity").change(function(){var a=parseFloat($("#price").text())*parseFloat($(this).val());$("#amount").html(a),$("#balanceLeft").html(e-a),a>=e&&($("input#quantity").attr("max",Math.floor(e/parseFloat($("#price").text()))),$("#quantityHelpBlock").html("Balance Limit Reached!"))}),$("#generatePin").click(function(){var e=Math.floor(9e3*Math.random())+1e3;$("#pin").closest(".form-group").removeClass("is-empty").addClass("is-dirty"),$("#pin").val(e)}),$(".promo_template_id").click(function(){$(".template_id").val($(this).val())}),$("#selectAll").click(function(){$("input:checkbox:visible").prop("checked",this.checked)}),$(".nfa_sms").click(function(){var e=!1;this.checked&&(e=!0),$.ajax({type:"POST",url:"/accounts/profile/bentity/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),submit:"nfa_sms",id:$(this).attr("data-id"),status:e}}).done(function(){}).fail(function(){return!1})}),$(".nfa_email").click(function(){var e=!1;this.checked&&(e=!0),$.ajax({type:"POST",url:"/accounts/profile/bentity/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),submit:"nfa_email",id:$(this).attr("data-id"),status:e}}).done(function(){}).fail(function(){return!1})}),$(".daily_report_sms").click(function(){var e=!1;this.checked&&(e=!0),$.ajax({type:"POST",url:"/accounts/profile/bentity/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),submit:"daily_report_sms",id:$(this).attr("data-id"),status:e}}).done(function(){}).fail(function(){return!1})}),$(".daily_report_email").click(function(){var e=!1;this.checked&&(e=!0),$.ajax({type:"POST",url:"/accounts/profile/bentity/",data:{csrfmiddlewaretoken:getCookie("csrftoken"),submit:"daily_report_email",id:$(this).attr("data-id"),status:e}}).done(function(){}).fail(function(){return!1})})});
